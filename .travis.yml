# from https://github.com/Parallels/atlassian-restrict-branch-model/blob/master/.travis.yml
sudo: false

language: java

before_install:
- wget https://marketplace.atlassian.com/download/plugins/atlassian-plugin-sdk-tgz
- mkdir opt
- tar -xvzf *plugin-sdk* -C opt
- mv opt/*plugin-sdk* opt/atlassian-plugin-sdk
- chmod a+x opt/atlassian-plugin-sdk/bin/*
- chmod a+x opt/atlassian-plugin-sdk/apache-maven-*/bin/*
- export PATH=opt/atlassian-plugin-sdk/bin:opt/atlassian-plugin-sdk/apache-maven-*/bin:$PATH
- atlas-version
install:
- atlas-mvn install
script:
- atlas-mvn package
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: uSlXaDnW/rI8KfJ0pmrdeYZCRnm0A6dc6DNOYP6F/nF8nucbTxYVptKaBMmGVdZFmt47kG7k2T3GwpdlUzlK9Sp3LWsmRspbsSs4iJ11WB85sk5LtjIqlO8RGlJxg90g9sZubcRViY7krvFPZX2H/0CVuLOpjkHf5/yNZu6D4f7K6kqXNFo0v0KB/ubOw7VxGnrjTAL5KkweLkFunsJlm51Bl2bXQXvp$
  file:
    - target/*.jar
  file_glob: true
  on:
    branch: master
